{"ast":null,"code":"var _jsxFileName = \"/Users/angentle/Documents/my_Workspace/REACT/isz-h5-hook/src/pages/step4/Step4.js\";\nimport React, { Component } from 'react';\nimport Steps from '../../components/steps';\nimport api from '../../api/index.js';\nimport { get } from '../../utils/global_data';\nimport './Step4.scss';\nconst formatObj = {\n  1: '初次申请',\n  2: '2年到期审验换证',\n  3: '补发申请'\n};\nconst sortObj = {\n  1: '驾驶证',\n  2: '丁类证书',\n  3: '培训合格证'\n};\nconst idcardObj = {\n  \"1\": \"身份证\",\n  \"2\": \"港澳通行证\",\n  \"3\": \"驾驶证\",\n  \"14\": \"回乡证\",\n  \"20\": \"护照\"\n}; // userInfo \n// \"mobileNo\": \"13023976727\",\n// \"loginName\": \"IYF2006191455\",\n// \"realNameStatus\": 1,\n// \"sex\": \"2\",\n// \"openId\": \"c4f9f7b5a98847569fa50a5caf8d165b\",\n// \"headImg\": null,\n// \"userName\": \"王艺泳\",\n// \"idcard\": \"350521199501211528\",\n// cardType:  1，身份证；2，港澳通行证；3，驾驶证；14，回乡证；20，护照\n\nconst sexObj = {\n  \"0\": '--',\n  \"1\": '男',\n  \"2\": '女'\n};\n\nclass Step4 extends Component {\n  constructor(props) {\n    super(props);\n\n    this.renderFile = (flag, list) => {\n      return flag && list.map((item, index) => /*#__PURE__*/React.createElement(\"img\", {\n        onClick: _ => this.sc.previewImages({\n          urls: [item.url],\n          index: 1\n        }),\n        alt: \"\",\n        className: \"img\",\n        key: 'files' + index,\n        src: item.url,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 17\n        }\n      }));\n    };\n\n    this.sc = window.sc;\n    this.state = {\n      oldDoc: [],\n      oneInch: [],\n      bodyCheck: [],\n      other: [],\n      isShowOldDoc: false,\n      format: 0,\n      sort: 0,\n      userInfo: {},\n      canSave: true // true可提交 false不可提交\n\n    };\n  }\n\n  componentDidMount() {\n    const form = get('form');\n    let state = {};\n\n    if (form) {\n      const {\n        files,\n        format,\n        sort\n      } = form;\n      state.format = format;\n      state.sort = sort;\n\n      if (format === 2) {\n        state.isShowOldDoc = true;\n      }\n\n      if (files && Object.keys(files).length) {\n        let {\n          oldDoc = [],\n          oneInch = [],\n          bodyCheck = [],\n          other = []\n        } = files;\n        state.oldDoc = oldDoc;\n        state.oneInch = oneInch;\n        state.bodyCheck = bodyCheck;\n        state.other = other;\n      }\n    }\n\n    const userInfo = get('userInfo');\n    state.userInfo = userInfo;\n    this.setState({ ...state\n    });\n  }\n\n  render() {\n    let {\n      userInfo,\n      canSave,\n      oldDoc,\n      oneInch,\n      bodyCheck,\n      other,\n      isShowOldDoc,\n      sort,\n      format\n    } = this.state;\n    const oldDocFlag = oldDoc && oldDoc.length === 0 ? false : true;\n    const oneInchFlag = oneInch && oneInch.length === 0 ? false : true;\n    const bodyCheckFlag = bodyCheck && bodyCheck.length === 0 ? false : true;\n    const otherFlag = other && other.length === 0 ? false : true;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"step4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Steps, {\n      activeStep: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }), userInfo && Object.keys(userInfo).length && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"item personInfo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 24\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 25\n      }\n    }, \"\\u4E2A\\u4EBA\\u4FE1\\u606F\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 33\n      }\n    }, \"\\u59D3\\u540D\\uFF1A\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 33\n      }\n    }, userInfo.userName)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 33\n      }\n    }, \"\\u6027\\u522B\\uFF1A\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 33\n      }\n    }, sexObj[userInfo.sex])), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 33\n      }\n    }, \"\\u8BC1\\u4EF6\\u7C7B\\u578B\\uFF1A\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 33\n      }\n    }, idcardObj[userInfo.cardType])), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 33\n      }\n    }, \"\\u8BC1\\u4EF6\\u53F7\\u7801\\uFF1A\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 33\n      }\n    }, userInfo.idcard)))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"item form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 21\n      }\n    }, \"\\u586B\\u5199\\u8868\\u5355\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 29\n      }\n    }, \"\\u7533\\u8BF7\\u8BC1\\u4E66\\u683C\\u5F0F\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 29\n      }\n    }, formatObj[format])), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 29\n      }\n    }, \"\\u7533\\u8BF7\\u9002\\u4EFB\\u8BC1\\u4E66\\u79CD\\u7C7B\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"value\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 29\n      }\n    }, sortObj[sort])))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"item upload\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 21\n      }\n    }, \"\\u4E0A\\u4F20\\u6750\\u6599\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 21\n      }\n    }, isShowOldDoc && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 42\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 29\n      }\n    }, \"\\u4E0A\\u4F20\\u65E7\\u8BC1\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"files\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 29\n      }\n    }, this.renderFile(oldDocFlag, oldDoc))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 29\n      }\n    }, \"\\u5927\\u4E00\\u5BF8\\u767D\\u5E95\\u5F69\\u7167\\uFF0C\\u62A4\\u7167\\u89C4\\u683C\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"files\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 29\n      }\n    }, this.renderFile(oneInchFlag, oneInch))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 29\n      }\n    }, \"\\u8EAB\\u4F53\\u6761\\u4EF6\\u8BC1\\u660E\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"files\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 29\n      }\n    }, this.renderFile(bodyCheckFlag, bodyCheck))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"inlineItem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 29\n      }\n    }, \"\\u5176\\u4ED6\\u76F8\\u5173\\u6750\\u6599\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"files\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 29\n      }\n    }, this.renderFile(otherFlag, other))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btnsWrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"btns\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn\",\n      onClick: _ => this.props.history.go(-1),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 25\n      }\n    }, \"\\u4E0A\\u4E00\\u6B65\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn\",\n      disabled: !canSave,\n      onClick: _ => this.onComfirm(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 25\n      }\n    }, \"\\u63D0\\u4EA4\"))));\n  }\n\n  onComfirm() {\n    let {\n      sc\n    } = this;\n    this.setState({\n      canSave: false\n    });\n    let {\n      userInfo,\n      format,\n      sort,\n      bodyCheck,\n      oldDoc,\n      oneInch,\n      other\n    } = this.state;\n    let {\n      userName,\n      mobileNo,\n      cardType,\n      idcard,\n      sex,\n      openId\n    } = userInfo;\n    let params = {\n      \"certificateFormat\": format,\n      \"certificateType\": sort,\n      \"files\": {\n        bodyCheck,\n        oldDoc,\n        oneInch,\n        other\n      },\n      userName,\n      mobileNo,\n      idcard,\n      sex,\n      openId,\n      cardType\n    };\n    api.boatLicenseSubmit(params).then(res => {\n      this.setState({\n        canSave: true\n      });\n\n      if (res.code === 200) {\n        sc.toast({\n          type: 'successText',\n          text: '提交成功',\n          detailText: ''\n        });\n        this.sleep().then(() => {\n          sc.close();\n        });\n      } else {\n        sc.toast({\n          type: 'errorText',\n          text: '提交失败',\n          detailText: ''\n        });\n      }\n    });\n  }\n\n  sleep(time = 1500) {\n    return new Promise(resolve => setTimeout(resolve, time));\n  }\n\n  getBirthday(idcard) {\n    return idcard.substr(6, 4) + '.' + idcard.substr(10, 2) + '.' + idcard.substr(12, 2);\n  }\n\n}\n\nexport default Step4;","map":{"version":3,"sources":["/Users/angentle/Documents/my_Workspace/REACT/isz-h5-hook/src/pages/step4/Step4.js"],"names":["React","Component","Steps","api","get","formatObj","sortObj","idcardObj","sexObj","Step4","constructor","props","renderFile","flag","list","map","item","index","_","sc","previewImages","urls","url","window","state","oldDoc","oneInch","bodyCheck","other","isShowOldDoc","format","sort","userInfo","canSave","componentDidMount","form","files","Object","keys","length","setState","render","oldDocFlag","oneInchFlag","bodyCheckFlag","otherFlag","userName","sex","cardType","idcard","history","go","onComfirm","mobileNo","openId","params","boatLicenseSubmit","then","res","code","toast","type","text","detailText","sleep","close","time","Promise","resolve","setTimeout","getBirthday","substr"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport Steps from '../../components/steps'\nimport api from '../../api/index.js'\nimport { get } from '../../utils/global_data'\nimport './Step4.scss'\n\n\nconst formatObj = {\n    1: '初次申请',\n    2: '2年到期审验换证',\n    3: '补发申请'\n}\n\nconst sortObj = {\n    1: '驾驶证',\n    2: '丁类证书',\n    3: '培训合格证'\n}\n\nconst idcardObj = {\n    \"1\": \"身份证\",\n    \"2\": \"港澳通行证\",\n    \"3\": \"驾驶证\",\n    \"14\": \"回乡证\",\n    \"20\": \"护照\"\n}\n\n\n// userInfo \n// \"mobileNo\": \"13023976727\",\n// \"loginName\": \"IYF2006191455\",\n// \"realNameStatus\": 1,\n// \"sex\": \"2\",\n// \"openId\": \"c4f9f7b5a98847569fa50a5caf8d165b\",\n// \"headImg\": null,\n// \"userName\": \"王艺泳\",\n// \"idcard\": \"350521199501211528\",\n// cardType:  1，身份证；2，港澳通行证；3，驾驶证；14，回乡证；20，护照\n\n\nconst sexObj = {\n    \"0\": '--',\n    \"1\": '男',\n    \"2\": '女'\n}\nclass Step4 extends Component {\n    constructor(props) {\n        super(props)\n        this.sc = window.sc\n        this.state = {\n            oldDoc: [],\n            oneInch: [],\n            bodyCheck: [],\n            other: [],\n            isShowOldDoc: false,\n            format: 0,\n            sort: 0,\n            userInfo: {},\n            canSave: true // true可提交 false不可提交\n        }\n    }\n\n    componentDidMount () {\n        const form = get('form')\n        let state = {}\n        if (form) {\n            const { files, format, sort } = form\n            state.format = format\n            state.sort = sort\n            if (format === 2) {\n                state.isShowOldDoc = true\n            }\n\n            if (files && Object.keys(files).length) {\n                let { oldDoc = [], oneInch = [], bodyCheck = [], other = [] } = files\n                state.oldDoc = oldDoc\n                state.oneInch = oneInch\n                state.bodyCheck = bodyCheck\n                state.other = other\n            }\n\n\n        }\n\n        const userInfo = get('userInfo')\n        state.userInfo = userInfo\n\n        this.setState({\n            ...state\n        })\n    }\n\n    render () {\n        let { userInfo, canSave, oldDoc, oneInch, bodyCheck, other, isShowOldDoc, sort, format } = this.state\n        const oldDocFlag = oldDoc && oldDoc.length === 0 ? false : true\n        const oneInchFlag = oneInch && oneInch.length === 0 ? false : true\n        const bodyCheckFlag = bodyCheck && bodyCheck.length === 0 ? false : true\n        const otherFlag = other && other.length === 0 ? false : true\n\n        return (\n            <div className='step4'>\n                <Steps activeStep={4} />\n                {(userInfo && Object.keys(userInfo).length)\n                    && <div className=\"item personInfo\">\n                        <div className=\"title\">\n                            个人信息\n                    </div>\n                        <div className=\"content\">\n                            <div className='inlineItem'>\n                                <div className=\"label\">\n                                    姓名：\n                            </div>\n                                <div className=\"value\">\n                                    {userInfo.userName}\n                                </div>\n                            </div>\n                            <div className='inlineItem'>\n                                <div className=\"label\">\n                                    性别：\n                            </div>\n                                <div className=\"value\">\n                                    {sexObj[userInfo.sex]}\n                                    {/* 默认 0，未知；1，男；2，女 */}\n                                </div>\n                            </div>\n\n                            <div className='inlineItem'>\n                                <div className=\"label\">\n                                    证件类型：\n                            </div>\n                                <div className=\"value\">\n                                    {idcardObj[userInfo.cardType]}\n                                </div>\n                            </div>\n\n                            <div className='inlineItem'>\n                                <div className=\"label\">\n                                    证件号码：\n                            </div>\n                                <div className=\"value\">\n                                    {userInfo.idcard}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                }\n                <div className=\"item form\">\n                    <div className=\"title\">\n                        填写表单\n                    </div>\n                    <div className=\"content\">\n                        <div className='inlineItem'>\n                            <div className=\"label\">\n                                申请证书格式\n                            </div>\n                            <div className=\"value\">\n                                {formatObj[format]}\n                            </div>\n                        </div>\n                        <div className='inlineItem'>\n                            <div className=\"label\">\n                                申请适任证书种类\n                            </div>\n                            <div className=\"value\">\n                                {sortObj[sort]}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"item upload\">\n                    <div className=\"title\">\n                        上传材料\n                    </div>\n                    <div className=\"content\">\n                        {isShowOldDoc && <div className='inlineItem'>\n                            <div className=\"label\">\n                                上传旧证\n                            </div>\n                            <div className=\"files\">\n                                {this.renderFile(oldDocFlag, oldDoc)}\n                            </div>\n                        </div>}\n                        <div className='inlineItem'>\n                            <div className=\"label\">\n                                大一寸白底彩照，护照规格\n                            </div>\n                            <div className=\"files\">\n                                {this.renderFile(oneInchFlag, oneInch)}\n                            </div>\n                        </div>\n                        <div className='inlineItem'>\n                            <div className=\"label\">\n                                身体条件证明\n                            </div>\n                            <div className=\"files\">\n                                {this.renderFile(bodyCheckFlag, bodyCheck)}\n                            </div>\n                        </div>\n\n                        <div className='inlineItem'>\n                            <div className=\"label\">\n                                其他相关材料\n                            </div>\n                            <div className=\"files\">\n                                {this.renderFile(otherFlag, other)}\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n                <div className=\"btnsWrap\">\n                    <div className=\"btns\">\n                        <button className='btn' onClick={_ => this.props.history.go(-1)}>\n                            上一步\n                        </button>\n                        <button className='btn' disabled={!canSave} onClick={_ => this.onComfirm()}>\n                            提交\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n        );\n    }\n\n    onComfirm () {\n\n        let { sc } = this\n\n        this.setState({\n            canSave: false\n        })\n        let { userInfo, format, sort, bodyCheck, oldDoc, oneInch, other } = this.state\n        let { userName, mobileNo, cardType, idcard, sex, openId } = userInfo\n        let params = {\n            \"certificateFormat\": format,\n            \"certificateType\": sort,\n            \"files\": {\n                bodyCheck,\n                oldDoc,\n                oneInch,\n                other\n            },\n            userName,\n            mobileNo,\n            idcard,\n            sex,\n            openId,\n            cardType\n        }\n\n        api.boatLicenseSubmit(params).then(res => {\n            this.setState({\n                canSave: true\n            })\n            if (res.code === 200) {\n                sc.toast({\n                    type: 'successText',\n                    text: '提交成功',\n                    detailText: ''\n                })\n                this.sleep().then(() => {\n                    sc.close();\n                })\n\n            } else {\n                sc.toast({\n                    type: 'errorText',\n                    text: '提交失败',\n                    detailText: ''\n                });\n            }\n        })\n\n    }\n\n    sleep (time = 1500) {\n        return new Promise((resolve) => setTimeout(resolve, time));\n    }\n\n    getBirthday (idcard) {\n        return idcard.substr(6, 4) + '.' + idcard.substr(10, 2) + '.' + idcard.substr(12, 2)\n    }\n\n    renderFile = (flag, list) => {\n        return (\n            flag && list.map((item, index) =>\n                <img onClick={_ => this.sc.previewImages({\n                    urls: [item.url],\n                    index: 1\n                })} alt='' className='img' key={'files' + index} src={item.url} />)\n        )\n    }\n}\n\nexport default Step4;\n"]},"metadata":{},"sourceType":"module"}